# Redis Replica Configuration
# Odoo 19 Stack - HA Cluster
# Role: Replica (Read-Only)

port 6379
bind 0.0.0.0
protected-mode no

# ═════════════════════════════════════════════════════════════
# PERSISTENCE (AOF only, RDB comes from master)
# ═════════════════════════════════════════════════════════════

appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

dir /data

# ═════════════════════════════════════════════════════════════
# REPLICATION
# ═════════════════════════════════════════════════════════════

# Connect to master (will be overridden by Sentinel on failover)
replicaof redis-master 6379
masterauth odoo19_redis_pass

# Replica is read-only
replica-read-only yes

# Continue serving stale data if connection to master is lost
replica-serve-stale-data yes

# ═════════════════════════════════════════════════════════════
# SECURITY
# ═════════════════════════════════════════════════════════════

requirepass odoo19_redis_pass

# ═════════════════════════════════════════════════════════════
# PERFORMANCE
# ═════════════════════════════════════════════════════════════

maxmemory 512mb
maxmemory-policy allkeys-lru

# ═════════════════════════════════════════════════════════════
# LOGGING
# ═════════════════════════════════════════════════════════════

loglevel notice
logfile ""
