# Redis Master Configuration
# Odoo 19 Stack - HA Cluster
# Role: Master (Read/Write)

port 6379
bind 0.0.0.0
protected-mode no

# ═════════════════════════════════════════════════════════════
# PERSISTENCE (RDB + AOF)
# ═════════════════════════════════════════════════════════════

# RDB Snapshots
save 900 1
save 300 10
save 60 10000

dbfilename dump.rdb
dir /data

# AOF (Append Only File)
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

# ═════════════════════════════════════════════════════════════
# REPLICATION
# ═════════════════════════════════════════════════════════════

# Require at least 1 replica to acknowledge writes
min-replicas-to-write 1
min-replicas-max-lag 10

# Replication timeout
repl-timeout 60

# ═════════════════════════════════════════════════════════════
# SECURITY
# ═════════════════════════════════════════════════════════════

requirepass odoo19_redis_pass
masterauth odoo19_redis_pass

# ═════════════════════════════════════════════════════════════
# PERFORMANCE
# ═════════════════════════════════════════════════════════════

# Max memory (will evict keys using LRU if exceeded)
maxmemory 512mb
maxmemory-policy allkeys-lru

# ═════════════════════════════════════════════════════════════
# LOGGING
# ═════════════════════════════════════════════════════════════

loglevel notice
logfile ""

# ═════════════════════════════════════════════════════════════
# SLOW LOG
# ═════════════════════════════════════════════════════════════

slowlog-log-slower-than 10000
slowlog-max-len 128
