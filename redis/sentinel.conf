# Redis Sentinel Configuration
# Odoo 19 Stack - HA Cluster
# Role: Monitor master and orchestrate failover

port 26379
bind 0.0.0.0
protected-mode no

# ═════════════════════════════════════════════════════════════
# MONITORING
# ═════════════════════════════════════════════════════════════

# Monitor master 'mymaster' at redis-master:6379
# Quorum: 2 sentinels must agree to declare master down
# Note: Using container name, will be resolved by Docker DNS
sentinel monitor mymaster odoo19_redis_master 6379 2
sentinel resolve-hostnames yes
sentinel announce-hostnames yes

# Authentication
sentinel auth-pass mymaster odoo19_redis_pass

# ═════════════════════════════════════════════════════════════
# FAILOVER PARAMETERS
# ═════════════════════════════════════════════════════════════

# Time (ms) master should be unreachable to be considered down
sentinel down-after-milliseconds mymaster 5000

# How many replicas can be reconfigured simultaneously during failover
sentinel parallel-syncs mymaster 1

# Timeout for failover operation
sentinel failover-timeout mymaster 10000

# ═════════════════════════════════════════════════════════════
# NOTIFICATION (Optional - for production)
# ═════════════════════════════════════════════════════════════

# sentinel notification-script mymaster /path/to/notify.sh
# sentinel client-reconfig-script mymaster /path/to/reconfig.sh

# ═════════════════════════════════════════════════════════════
# LOGGING
# ═════════════════════════════════════════════════════════════

loglevel notice
logfile ""

# ═════════════════════════════════════════════════════════════
# SENTINEL CONFIGURATION PERSISTENCE
# ═════════════════════════════════════════════════════════════

dir /tmp
