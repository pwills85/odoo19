ID,Severidad,Componente,Descripción,Archivo,Línea,Evidencia,Impacto,Causa Raíz,Recomendación,Esfuerzo (h),Dueño,Sprint,Estado
P0-001,BLOQUEANTE,Models,Antipatrón _name duplicado en account.move,models/account_move_dte.py,51-52,"_name = 'account.move' junto a _inherit = 'account.move'","Sobrescribe modelo base Odoo, corrupción datos, conflictos con otros módulos, imposible upgrade Odoo 20",Uso incorrecto patrón herencia Odoo,Eliminar línea _name. Solo usar _inherit = 'account.move',2,Backend Lead,Sprint 0,Pendiente
P0-002,BLOQUEANTE,Testing,Sin smokes XSD automatizados DTEs 33/34/56/61,tests/,N/A,find tests -name smoke_xsd_*.py → No such file or directory,DTEs inválidos enviados al SII (rechazo automático). Sin detección regresiones XSD. Incumplimiento Res. SII 80/2014,Falta automatización validaciones XSD obligatorias,"Crear 7 smoke tests: 33, 34, 52(sin val), 52(con val), 52(transporte), 56, 61",24,QA Lead + Backend,Sprint 0,Pendiente
P0-003,BLOQUEANTE,Security,Rate limiting in-memory (no persistente),controllers/dte_webhook.py,25,_request_cache = {} (comentario: en producción usar Redis),No funciona Gunicorn/uWSGI (workers separados). Se pierde al reiniciar. Exposición DoS. No cumple OWASP API Security,Implementación temporal no escalable,Migrar a Redis con ir.config_parameter para host/port/db. Usar redis.incr() con TTL,8,Backend + DevOps,Sprint 0,Pendiente
P0-004,BLOQUEANTE,Security,Falta validación timestamp/nonce en webhooks,controllers/dte_webhook.py,109-130,verify_hmac_signature() solo valida HMAC. Sin timestamp ni nonce,Vulnerable a replay attacks. No cumple OWASP API A5. Posible DoS con webhooks válidos repetidos. Sin expiración requests,Protección parcial contra ataques. HMAC solo valida integridad,"Agregar headers X-Webhook-Timestamp, X-Webhook-Nonce. Validar ventana 5 min. Check nonce en Redis (replay protection)",12,Backend + Security,Sprint 0,Pendiente
P0-005,BLOQUEANTE,CI/CD,Sin cobertura verificable de tests (CI/CD ausente),CI/CD pipeline,N/A,ls .github/workflows/ → No such file or directory,Imposible verificar cobertura real (objetivo ≥80%). Regresiones pasan desapercibidas. Sin gates de calidad. No cumple ISO 25010,Falta automatización pipeline CI/CD,Crear GitHub Actions con lint/type-check/tests/coverage. pytest.ini con --cov-fail-under=80. Badge en README,16,DevOps + QA,Sprint 0,Pendiente
P0-006,BLOQUEANTE,Configuration,Configuración Redis no parametrizada,data/,N/A,grep redis data/*.xml → No se encontraron parámetros,P0-003 no puede implementarse sin config. AI Service sessions no funcionales. Deployment manual. Sin separation of concerns,Redis mencionado en docs pero no integrado operativamente,Crear data/ir_config_parameter_defaults.xml con redis_host/port/db. Vista en res.config.settings. Environment variables override,8,Backend + DevOps,Sprint 0,Pendiente
P1-001,ALTA,SOAP Client,Sin exponential backoff con jitter en retry,libs/sii_soap_client.py,174,@retry(stop=stop_after_attempt(3)) sin wait_exponential ni jitter,Reintentos agresivos sobrecargan SII. Posible ban temporal. No cumple mejores prácticas resilencia,Retry básico sin backoff exponencial,"Agregar wait_exponential(multiplier=1, min=2, max=30) + wait_random(0, 2) para jitter",4,Backend,Sprint 1,Pendiente
P1-002,ALTA,XML Generation,Falta validación condicional PrcItem=0 (DTE 52),libs/xml_generator.py,N/A,DTE 52 sin valorización debe omitir <PrcItem> cuando precio=0,DTEs 52 rechazados por SII. Incumplimiento especificación XSD variantes,Falta lógica condicional para omitir campos según variante,"Agregar lógica: if dte_type==52 and precio==0: omit PrcItem, MontoItem. Tests para 3 variantes DTE 52",6,Backend,Sprint 1,Pendiente
P1-003,ALTA,SII Integration,Sin manejo completo de 59 códigos SII,models/dte_communication.py,N/A,Solo maneja códigos comunes. Falta mapping 59 códigos + glosas + soluciones,Errores SII no interpretados correctamente. Usuario sin guía para resolver. Incumplimiento compliance,Documentación incompleta códigos SII,"Crear data/sii_error_codes.xml con 59 códigos, glosas, soluciones. Método _get_sii_error_solution(code)",8,Backend,Sprint 1,Pendiente
P1-004,ALTA,Security,Certificados temporales sin cleanup garantizado,libs/xml_signer.py,N/A,import tempfile. Comentario: Performance ~30ms per signature,Fuga certificados en /tmp si proceso crashea. Acumulación archivos temporales. Posible acceso no autorizado,Archivos temporales sin context manager,"Context manager secure_temp_certificate() con os.chmod(0o600), cleanup en finally, sobrescribir antes de unlink",6,Backend,Sprint 1,Pendiente
P1-005,ALTA,Performance,Falta pooling de conexiones SOAP,libs/sii_soap_client.py,N/A,Nueva conexión por request,Degradación performance en carga alta. Latencia innecesaria. Agotamiento conexiones,Sin reutilización conexiones,"requests.Session() con HTTPAdapter(pool_connections=20, pool_maxsize=20)",8,Backend,Sprint 1,Pendiente
P1-006,ALTA,Observability,Sin métricas p50/p95/p99,Todos,N/A,No hay monitoreo de performance,Imposible detectar degradación. Sin datos para SLA. No cumple objetivo p95 < 500ms,Falta instrumentación,"Prometheus + Grafana. @prometheus_histogram decorators. Métricas: dte_generation_duration_seconds, soap_call_duration_seconds",12,Backend + DevOps,Sprint 1,Pendiente
P1-007,ALTA,DTE Validation,TED sin validación hash externa,libs/ted_generator.py,N/A,Genera TED pero no valida hash con herramienta externa,TED inválido no detectado. Rechazo en SII. Incumplimiento Res. 80/2014 Art. 6,Falta validación cruzada con xmlsec,"Test que genera TED, exporta XML, valida con xmlsec1 externo. Verificar hash RSA-SHA1",6,Backend + QA,Sprint 1,Pendiente
P1-008,ALTA,RCV,RCV sin tests automatizados,models/l10n_cl_rcv_*.py,N/A,Modelos RCV existen pero sin tests,RCV (obligatorio Res. 61/2017) puede fallar en producción sin detección,Falta cobertura tests,"Smoke tests: crear período RCV, agregar entries, sincronizar SII (mock), validar CSV export",8,QA + Backend,Sprint 1,Pendiente
P2-001,MEDIA,Security,Uso excesivo de sudo() (20 instancias),Múltiples,Varias,grep sudo() → 20 resultados,Elevación privilegios innecesaria. Bypasea reglas multi-company. Potencial fuga datos,sudo() usado sin justificación,"Auditar cada uso. Eliminar innecesarios. Documentar necesarios con # SECURITY: reason",12,Backend,Sprint 2,Pendiente
P2-002,MEDIA,Data Integrity,Falta validación unicidad RUT,models/res_partner_dte.py,N/A,Sin SQL constraint ni Python constraint para RUT único,Duplicación RUTs en DB. Inconsistencias reportes SII. Problemas RCV,Sin constraint unicidad,"_sql_constraints = [('vat_uniq_cl', 'unique(vat, company_id)', '...')]. Python constraint adicional",4,Backend,Sprint 2,Pendiente
P2-003,MEDIA,Security,Logging con información sensible,Múltiples,Varias,_logger con cert_data/password sin sanitizar,Passwords/keys en logs. Incumplimiento GDPR/Ley 19.628. Vulnerabilidad seguridad,Logs sin sanitización,"Helper sanitize_log_data(). Filtrar ['password', 'cert_password', 'private_key', 'secret']",8,Backend,Sprint 2,Pendiente
P2-004,MEDIA,Performance,Falta cache de CAF,libs/ted_generator.py,N/A,Query DB por cada TED generado,Degradación performance lotes grandes. Posible timeout generación masiva,Sin cache de CAFs,"@lru_cache(maxsize=128) en _get_caf_for_folio(). Cache evita queries repetidas",6,Backend,Sprint 2,Pendiente
P2-005,MEDIA,Performance,Sin paginación en sync RCV,models/l10n_cl_rcv_integration.py,N/A,Sincroniza todos los entries sin batching,Timeout en períodos con muchos DTEs. Consumo excesivo memoria. Posible crash alto volumen,Procesamiento sin paginación,"Batch de 1000 entries. Commit intermedio. offset/limit en loop. Progress logging",10,Backend,Sprint 2,Pendiente
P2-006,MEDIA,Security,Falta validación tamaño XML (DoS),libs/xml_signer.py,70,sign_xml_dte() sin validar tamaño xml_string,Posible DoS con XMLs gigantes. Consumo excesivo memoria. Timeout firma documentos grandes,Sin protección DoS,"MAX_XML_SIZE = 10MB. Validar len(xml_string.encode('utf-8')) antes de procesar",2,Backend,Sprint 2,Pendiente
P2-007,MEDIA,Architecture,Falta factory pattern,libs/,N/A,Instancias creadas manualmente en modelos,Boilerplate repetido. Dificulta testing. Acoplamiento,Sin factory para DI,"Crear DTEServiceFactory(env) con métodos get_xml_signer(), get_soap_client(), etc.",8,Backend,Sprint 2,Pendiente
P2-008,MEDIA,i18n,i18n incompleto (.pot desactualizado),i18n/,N/A,Strings nuevas sin traducir. .pot antiguo,Interfaz en inglés para usuarios chilenos. Mala UX. Strings hardcodeadas sin _(),Falta actualizar traducciones,"odoo-bin --i18n-export. Revisar strings sin _(). Actualizar es_CL.po",4,Backend,Sprint 2,Pendiente
P2-009,MEDIA,Testing,Sin disaster recovery tests,tests/,N/A,Modelos dte_backup/dte_failed_queue sin tests,Disaster recovery no verificado. Posible falla en producción,Falta cobertura tests,"Tests: crear backup, restaurar, retry failed queue, verificar integridad",8,QA,Sprint 2,Pendiente
P2-010,MEDIA,Documentation,Falta documentación API (OpenAPI),docs/,N/A,Sin especificación OpenAPI/Swagger para webhooks,Integraciones externas difíciles. Sin contrato API formal. Errores de integración,Sin documentación formal API,"Crear docs/openapi.yml. Documentar POST /api/dte/callback con schemas, headers, responses",6,Backend,Sprint 2,Pendiente
P2-011,MEDIA,Performance,Performance tests ausentes,tests/,N/A,Sin tests de carga. p95 < 500ms no verificado,Objetivo p95 < 500ms no verificable. Sin detección degradación. Sin baseline,Falta performance testing,"Locust tests: 100 usuarios, 1000 DTEs/h. Medir p50/p95/p99. Grafana dashboard",12,QA + DevOps,Sprint 2,Pendiente
P2-012,MEDIA,Documentation,Falta CHANGELOG estructurado,-,N/A,CHANGELOG.md existe pero no sigue Keep a Changelog,Difícil rastrear cambios. Sin categorización (Added/Changed/Fixed/Deprecated),CHANGELOG sin estructura,"Migrar a formato Keep a Changelog. Secciones: Added, Changed, Deprecated, Removed, Fixed, Security",2,Backend,Sprint 2,Pendiente
P3-001,BAJA,Documentation,Docstrings en español (aceptable),-,N/A,Docstrings en español vs PEP257 inglés,PEP257 recomienda inglés. Pero localización en español es aceptable,Decisión consciente para localización chilena,Aceptado. Facilita mantenimiento por devs hispanohablantes,0,N/A,N/A,Aceptado
P3-002,BAJA,Code Quality,42 TODOs/FIXMEs pendientes,Múltiples,Varias,grep TODO → 42 resultados,Deuda técnica acumulada. Dificulta mantenimiento,TODOs sin rastreo ni priorización,Convertir en issues GitHub con labels priority:low/medium/high,16,Backend,Backlog,Pendiente
P3-003,BAJA,Testing,Archivos demo deshabilitados,data/,N/A,'demo': [] vacío,Dificulta pruebas nuevos devs. Sin datos para demos/capacitaciones,Sin datos de demostración,"Crear data/demo_dte_data.xml con certificado sandbox, CAF demo, factura ejemplo",8,Backend,Backlog,Pendiente
P3-004,BAJA,Documentation,Falta diagramas actualizados,docs/,N/A,Diagrama arquitectura desactualizado (2025-10-24),Arquitectura migró a nativa pero diagrama muestra microservicio,Documentación desactualizada,Actualizar diagramas con arquitectura actual (libs/ nativas). Mermaid o PlantUML,6,Arquitecto,Backlog,Pendiente
P3-005,BAJA,Documentation,Sin badges de estado en README,README.md,N/A,Sin badges Tests/Coverage/Quality,No se visualiza estado del proyecto. Falta transparencia,README básico,Agregar badges GitHub Actions/Codecov/SonarCloud,2,DevOps,Backlog,Pendiente
P3-006,BAJA,Housekeeping,Carpeta .deprecated no eliminada (2MB),.deprecated/,N/A,ls .deprecated → 2MB archivos antiguos,Confusión. Peso innecesario repositorio. Dificulta navegación,Archivos antiguos no eliminados,"git rm -rf .deprecated/. Backup en branch archive/deprecated si necesario",1,Backend,Backlog,Pendiente
P3-007,BAJA,Housekeeping,__pycache__ versionado en Git,__pycache__/,N/A,find . -name __pycache__ → múltiples resultados,Cache innecesaria en Git. Aumenta tamaño repo. Conflictos merge,Falta .gitignore correcto,"Agregar __pycache__/ a .gitignore. git rm -rf --cached **/__pycache__",1,DevOps,Backlog,Pendiente
P3-008,BAJA,Documentation,Falta guía de contribución,-,N/A,Sin CONTRIBUTING.md,Contribuciones externas difíciles. Sin guías de estilo/proceso,Sin documentación para contributors,"Crear CONTRIBUTING.md: setup local, coding style, PR template, testing, CI/CD",4,Backend,Backlog,Pendiente
REP-C001,BLOQUEANTE,Reportes,F29/F22 models no importan submódulos core/services,-,N/A,Errores arquitectura al cargar modelos,Acoplamiento y falta modularidad,Falta paquete core y __init__ con imports explícitos,"Creado método y organización revisada; ver implementación F29/F22",6,desarrollo_reportes,Sprint 1,CERRADO
REP-C002,BLOQUEANTE,Reportes,Vista F29 referencia campos inexistentes,-,N/A,MissingError al abrir vista usuario,Interfaz rota y bloqueo operación,Definición de vista desalineada con modelo,Vista alineada con campos reales y validada en auditoría,4,desarrollo_reportes,Sprint 1,CERRADO
REP-C003,BLOQUEANTE,Reportes,TypeError period_date en cálculo F29,-,N/A,Excepción runtime en cálculo,Falla tipo de dato y conversión fecha,Lógica cálculo usa nombre campo incorrecto,Corrección aplicada en método action_calculate,5,desarrollo_reportes,Sprint 1,CERRADO
REP-C004,BLOQUEANTE,Reportes,XML report F29 incrusta registros erróneos,-,N/A,XML malformado account.report,Render incorrecto y rechazo validaciones,Plantilla mezcla objetos sin loop controlado,QWeb verificado sin embedding indebido,6,desarrollo_reportes,Sprint 1,CERRADO
REP-C005,BLOQUEANTE,Reportes,KeyError integración SII F22,-,N/A,Excepción al mapear claves,SII mapping incompleto,Falta diccionario robusto claves F22,Servicio integración estable sin KeyError,6,desarrollo_reportes,Sprint 1,CERRADO
REP-C006,BLOQUEANTE,Reportes,Cron create_monthly_f29() ausente,-,N/A,Falta generación automática,F29 no se genera oportunamente,No se definió tarea programada,Método create_monthly_f29 implementado + tests,3,desarrollo_reportes,Sprint 1,CERRADO
